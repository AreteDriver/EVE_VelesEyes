# Argus Overview Flatpak Manifest
#
# NOTE: This application requires deep X11 integration (wmctrl, xdotool)
# which is challenging to package in Flatpak's sandbox.
#
# RECOMMENDED: Use native installation instead:
#   ./install.sh
#   ~/argus-overview/run.sh
#
# This manifest is provided as a starting point for future Flatpak support.
# Full Flatpak packaging would require:
# 1. Building libXmu from source (for wmctrl)
# 2. Building wmctrl from source
# 3. Building xdotool from source
# 4. Bundling PySide6 (~500MB)
# 5. Configuring X11 socket access properly
#
# For now, native installation is the supported method.

app-id: io.github.aretedriver.ArgusOverview
runtime: org.freedesktop.Platform
runtime-version: '24.08'
sdk: org.freedesktop.Sdk
command: argus-overview

finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --device=dri
  - --share=network
  - --talk-name=org.freedesktop.Notifications
  - --filesystem=home
  - --filesystem=~/.config/argus-overview:create
  - --filesystem=~/.local/share/argus-overview:create

modules:
  - name: argus-overview
    buildsystem: simple
    build-commands:
      - mkdir -p /app/bin
      - mkdir -p /app/share/argus-overview
      - cp -r src/* /app/share/argus-overview/
      - mkdir -p /app/share/argus-overview/assets
      - cp -r assets/* /app/share/argus-overview/assets/ || true
      - |
        cat > /app/bin/argus-overview << 'EOF'
        #!/bin/bash
        echo "==========================================="
        echo "Argus Overview - Flatpak Notice"
        echo "==========================================="
        echo ""
        echo "This application requires X11 tools (wmctrl, xdotool)"
        echo "that are not fully supported in Flatpak's sandbox."
        echo ""
        echo "Please use native installation instead:"
        echo ""
        echo "  git clone https://github.com/AreteDriver/Argus_Overview"
        echo "  cd Argus_Overview"
        echo "  ./install.sh"
        echo "  ~/argus-overview/run.sh"
        echo ""
        echo "==========================================="
        EOF
      - chmod +x /app/bin/argus-overview
      - install -Dm644 flatpak/io.github.aretedriver.ArgusOverview.desktop /app/share/applications/io.github.aretedriver.ArgusOverview.desktop
      - install -Dm644 assets/icon_256.png /app/share/icons/hicolor/256x256/apps/io.github.aretedriver.ArgusOverview.png || install -Dm644 assets/icon.png /app/share/icons/hicolor/256x256/apps/io.github.aretedriver.ArgusOverview.png || true
      - install -Dm644 flatpak/io.github.aretedriver.ArgusOverview.metainfo.xml /app/share/metainfo/io.github.aretedriver.ArgusOverview.metainfo.xml
    sources:
      - type: dir
        path: ..
